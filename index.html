<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Guardian Cat</title>
		<script src="phaser.js"></script>
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
		<script src="https://code.jquery.com/jquery.js"></script>
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
	</head>
	<body>
		<div class="container">
			<div id="splash" style="width: 800px; height: 600px; background-image: url('bg.jpg'); background-size: 800px 600px; background-repeat: no-repeat;"><div style="width: 800px; height: 600px; background-image: url('cat-full.png'); background-size: 800px 600px; background-repeat: no-repeat;">
				<div class="progress progress-striped active">
					<div class="progress-bar" id="progbar" role="progressbar" style="width: 0%"></div>
				</div>
				<div class="jumbotron">
					<h1>Guardian Cat <small>#ScratchTheCat</small></h1>
					<p class="lead">You're not a good guardian cat. You let that little boy climb up. Now find him, will ya?</p>
					<p class="lead">Controls: <span class="glyphicon glyphicon-arrow-left"></span><span class="glyphicon glyphicon-arrow-up"></span><span class="glyphicon glyphicon-arrow-down"></span><span class="glyphicon glyphicon-arrow-right"></span></p>
					<button id="startbutton" type="button" onClick="unlock();" class="btn btn-primary btn-lg btn-block"  style="display:none;">Play</button>
				</div>
			</div></div>
			<div id="gameframe" style="width: 800px; height: 600px; display:none;">
			</div>

		<script type="text/javascript">
			var game = new Phaser.Game(800, 600, Phaser.AUTO, document.getElementById('gameframe'), {preload: preload, create: create, update: update});
			var platforms;
			var player;
			var cursors;
			var upforms;
			var sky;
			var started = false;
			function preload() {
				game.load.spritesheet('catsht', 'cat.png', 75, 46);
				$('#progbar').css('width', 100/12*1+'%');
				game.load.image('gr', 'gr.png');
				$('#progbar').css('width', 100/12*2+'%');
				game.load.image('int', 'int.png');
				$('#progbar').css('width', 100/12*3+'%');
				game.load.image('plup', 'plup.png');
				$('#progbar').css('width', 100/12*4+'%');
				game.load.image('sky', 'sky.png');
				$('#progbar').css('width', 100/12*5+'%');
				game.load.image('lm', 'lm.png');
				$('#progbar').css('width', 100/12*6+'%');
			}
			function create() {
				game.world.setBounds(0, 0, 800, 3200);
				sky = game.add.sprite(0, 0, 'sky');
				$('#progbar').css('width', 50+50/15*1+'%');

				var temp;
				temp = game.add.sprite(0, game.world.height - 600, 'int');
				$('#progbar').css('width', 50+50/15*2+'%');

				platforms = game.add.group();
				$('#progbar').css('width', 50+50/15*3+'%');

				temp = platforms.create(0, game.world.height - 50, 'gr');
				temp.scale.setTo(8, 1);
				temp.body.immovable = true;
				$('#progbar').css('width', 50+50/15*4+'%');

				temp = platforms.create(650, game.world.height - 150, 'lm');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*5+'%');

				temp = platforms.create(500, game.world.height - 250, 'lm');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*6+'%');

				temp = platforms.create(0, game.world.height - 350, 'lm');
				temp.scale.setTo(4, 1);
				temp.body.immovable = true;
				$('#progbar').css('width', 50+50/15*7+'%');

				temp = platforms.create(200, game.world.height - 450, 'lm');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*8+'%');

				temp = platforms.create(50, game.world.height - 550, 'lm');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*9+'%');

				temp = platforms.create(200, game.world.height - 650, 'lm');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*10+'%');

				temp = platforms.create(400, game.world.height - 750, 'lm');
				temp.scale.setTo(4, 1);
				temp.body.immovable = true;
				$('#progbar').css('width', 50+50/15*11+'%');

				upforms = game.add.group();

				temp = upforms.create(300, game.world.height - 850, 'plup');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*12+'%');

				temp = upforms.create(200, game.world.height - 1100, 'plup');
				temp.scale.setTo(1, 1);
				temp.body.immovable = true;
				temp.body.collideWorldBounds = true;
				$('#progbar').css('width', 50+50/15*13+'%');

				player = game.add.sprite(32, game.world.height - 200, 'catsht');
				player.animations.add('left', [0], 10, true);
				player.animations.add('right', [1], 10, true);
				player.body.bounce.setTo(0.04, 0.04);
				player.body.collideWorldBounds = true;
				player.body.gravity.y = 5;
				$('#progbar').css('width', 50+50/15*14+'%');

				game.camera.follow(player);
				$('#progbar').css('width', 50+50/15*15+'%');
				$('#startbutton').slideDown();
			}
			function unlock() {
				$('#splash').slideUp();
				$('#gameframe').slideDown();
				cursors = game.input.keyboard.createCursorKeys();
				started = true;
			}
			function update() {
				if (started) {
					game.physics.collide(player, platforms);
					game.physics.collide(player, upforms, upShot, null, this);
					game.physics.collide(platforms, upforms);
					player.body.velocity.x = player.body.velocity.x / 3;
					if (cursors.left.isDown) {
						player.body.velocity.x += -100;
						player.animations.play('left');
					}
					if (cursors.right.isDown) {
						player.body.velocity.x += 100;
						player.animations.play('right');
					}
					if (cursors.up.isDown) {
						if (player.body.touching.down)
							player.body.velocity.y += -310;
					}
				}
			}
			function upShot(obj1, obj2) {
				if (player.body.touching.down)
					player.body.velocity.y += -450;
			}
		</script>
	</body>
</html>
